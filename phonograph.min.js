(function(){function a(a){return Object.prototype.toString.call(a)==="[object Array]"}function b(a){return typeof a!="undefined"&&a!==null}function c(a,b,c,d,e){b[a](c,d,e||!1)}"use strict";var d=c.bind(this,"addEventListener"),e=c.bind(this,"removeEventListner"),f={init:function(){this.audio=document.createElement("audio")},play:function(a){this.playAt(0,a)},playAt:function(a,c){if(!b(c)){this.audio.currentTime=a;return}var f=this.audio,g=function(b){e(f,"canplay",g,!1),f.currentTime=a,f.play()};d(f,"canplay",g,!1),f.src=c},pause:function(){return this.audio.pause(),!0},isPaused:function(){return this.audio.paused}},g=Object.create(f);g.init=function(){this.lastSavedPosition=0,this.tracks=[],this.current=0,this.super=f,this.super.init.call(this);var a=this;d(a.audio,"ended",function(b){var c=a.tracks;c.length>0&&c.length-1!==a.current&&(a.current++,a.play(),a.onTrackChanged())},!1)},g.playAt=function(a){var c=this.super.playAt.call;if(!b(a)){c(this,this.lastSavedPosition,this.tracks[this.current]);return}this.tracks.length>0&&c(this,a,this.tracks[this.current])},g.play=function(a){b(a)&&(this.clear(),this.add(a),this.current=0),a.length>0&&this.super.play.call(this,this.tracks[this.current])},g.add=function(b){if(!a(b)){this.tracks.push(b);return}var c=this.add;b.forEach(function(a){c(a)})},g.clear=function(){this.tracks=[]},g.savePosition=function(){this.lastSavedPosition=this.audio.currentTime},g.trackChanged=function(a){this.onTrackChanged=a},f.create=g.create=function(){var a=Object.create(this);return a.init(),a},this.Phonograph=f,this.Record=g}).call(this);